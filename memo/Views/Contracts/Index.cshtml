@using System.Globalization;

@{
    ViewData["Title"] = "Rámcové smlouvy";
}

@* @model IList<memo.Models.Offer> *@

<style>
    .notesWrap {
        max-width: 200px;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .centerHeader {
        text-align: center;
    }

    .fixed-table-body {
        max-width: 100%;
    }

    .bootstrap-table .fixed-table-container .table thead th .sortable {
        padding-right: 20px!important;
    }

    .itemInactive {
        color: #9ba8b1;
    }

    .table-responsive {
        position: absolute;
        left: 2rem;
        width: calc(100% - 4rem);
        overflow-x: inherit;
    }
</style>

@await Html.PartialAsync("_PartialToastNotification")

<div class="text-center">
    <h1 class="display-4">@ViewData["Title"]</h1>
</div>

<div id="toolbar" style="padding-bottom: 10px;">
    <a asp-action="Create" class="btn btn-outline-success">
        <i class="fa fa-plus-square-o"></i> Nová rámcová smlouva
    </a>
    @* <button style="margin-right: 5px;" class="btn btn-outline-info" name="BtnMujFilter" id="BtnMujFilter" type="button">
        <i class="fa fa-filter"></i> Filter
    </button>
    @if (ViewBag.ShowInactive == true)
    {
        <a asp-action="index" class="btn btn-outline-secondary" data-toggle="tooltip" title="Zobrazit pouze aktivní"><i class="fa fa-eye"></i> Vše (@Model.Count())</a>
    }
    else
    {
        <a asp-action="index" class="btn btn-outline-secondary" asp-route-ShowInactive="true" data-toggle="tooltip" title="Zobrazit vše"><i class="fa fa-eye-slash"></i> Aktivní (@Model.Count()/@ViewBag.AllOffersCount)</a>
    } *@
</div>

<div class="table-responsive">
<table
    id="table"
    class="table table-sm text-xsmall text-nowrap"
    style="width:100%"
    data-cookie="true"
    data-cookie-id-table="offersTableCookie"
    data-filter-control="false"
    data-footer-style="footerStyle"
    data-height="800"
    data-maintain-meta-data="true"
    @* data-pagination="true" *@
    data-show-search-clear-button="true"
    data-show-toggle="true"
    data-show-columns-toggle-all="true"
    data-show-columns="true"
    data-export-data-type="basic"  @* 'basic', 'all', 'selected' *@
    data-export-footer=false  @* false, true *@
    data-export-types="['txt', 'csv', 'excel']"  @* ['json', 'xml', 'csv', 'txt', 'sql', 'excel', 'png', 'doc', 'xlsx', 'pdf'] *@
    data-show-fullscreen="true"
    data-sort-name="CreatedDate"
    data-sort-order="desc"
    data-search="true"
    data-silent-sort="true"
    data-show-footer="true"
    data-toolbar="#toolbar"
    data-toggle="table"
    data-visible-search="true"
    @* data-reorderable-columns="true" *@
    @* data-show-pagination-switch="true" *@
    @* data-page-size="50" *@
    @* data-page-list="[10, 25, 50, 100, 200, All]" *@
    style="font-size: 0.9em;"
    >
    <thead>
        <tr>
            <th scope="col" class="text-center" data-field="0" data-sortable="true" data-filter-control="input" data-footer-formatter="idFormatter">Edit</th>
            <th scope="col" class="text-center" data-field="1" data-sortable="true"><span data-toggle="tooltip" title="Aktivní / Neaktivní"><i class="fa fa-eye text-secondary"></i></span></th>
            <th scope="col" class="text-center" data-field="2" data-sortable="true" data-filter-control="input">Status</th>
            <th scope="col" class="text-center" data-field="3" data-sortable="true" data-filter-control="input">Vytvořeno</th>
            <th scope="col" class="text-center" data-field="4" data-sortable="true" data-filter-control="input">Předmět</th>
            <th scope="col" class="text-center" data-field="5" data-sortable="true" data-filter-control="input">Kontakt</th>
            <th scope="col" class="text-right" data-field="6" data-sortable="true" data-filter-control="input">Firma</th>
            <th scope="col" class="text-center" data-field="7" data-sortable="true" data-filter-control="input">Cena</th>
            <th scope="col" class="text-center" data-field="8" data-sortable="true" data-filter-control="input">Cena [CZK]</th>
            <th scope="col" class="text-center" data-field="9" data-sortable="true" data-filter-control="input">Měna</th>
            <th scope="col" class="text-center" data-field="15" data-sortable="true" data-filter-control="input">Poznámky</th>
        </tr>
    </thead>
    <tbody>

    </tbody>
</table>
</div>
@*
<!-- Modal Confirm Delete-->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <!-- header -->
            <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">Smazání nabídky</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
            <!-- body -->
            <div class="modal-body">
                Opravdu smazat?
                <span id="modalItemId"></span>
            </div>
            <!-- footer -->
            <div class="modal-footer">
                <a href="#" class="btn btn-default" data-dismiss="modal">Zpět</a>
                <a href="#" class="btn btn-danger" onclick="DeleteItem()">Smazat</a>
            </div>
        </div>
    </div>
</div> *@

@*hidden field for storing current Id*@
@* <input type="hidden" id="hiddenId" /> *@

@section scripts{
<script>
//
//    // Reinitialize tooltips upon table change
//    $('#table').on('post-body.bs.table', function () {  // on('all.bs.table'
//        $('[data-toggle="tooltip"]').tooltip()
//    });
//
//    // POST delete command to controller
//    //----------------------------------
//    function DeleteItem() {
//        var itemId = $("#hiddenId").val();
//        $.ajax({
//            type: "POST",
//            url: '@Url.Action("Delete", "Offers")',
//            data: { Id: itemId },
//            beforeSend: function (request) {
//                request.setRequestHeader("RequestVerificationToken", $("[name='__RequestVerificationToken']").val());
//            },
//            success: function () {
//                $("#myModal").modal("hide")
//                //$("#row_" + itemId).remove();
//                window.location = "Offers/Index"
//            },
//            error: function() {
//                alert("Tento nabídka nelze z nějakého důvodu odstranit...");
//                $("#myModal").modal("hide");
//            }
//        })
//    }


//    // MODAL dialog for delete confirmation
//    //-------------------------------------
//    var ConfirmDelete = function (ItemId) {
//        $("#hiddenId").val(ItemId);
//        $("#myModal").modal('show');
//        $("#modalItemId").val( 'Hmm' + ItemId );
//    };


//    // Function to toggle Active/Disabled Contacts/Companies in table
//    //---------------------------------------------------------------
//    function ToggleActive() {
//        var btn = document.getElementById("btnToggleActive");
//
//        if (btn.children[0].className == "fa fa-eye-slash") {
//            // Change icon and text
//            btn.children[0].className = "fa fa-eye"
@* //            btn.lastChild.nodeValue = " Všichni (@Model.Count())" *@
//            // Get class('hide') elements and copy to normal array
//            //var hiddenRows = document.getElementsByClassName("hide");
//            //elementArray = [].slice.call(hiddenRows, 0);
//            //for(var i = elementArray.length - 1; i >= 0; i--){
//            //    hiddenRows[i].className = "show hiddenBefore";
//            //};
//
//            var hiddenRows = document.querySelectorAll(".hide");
//            console.log(hiddenRows);
//            for(var i = 0; i < hiddenRows.length; i++){
//                hiddenRows[i].className = "show hiddenBefore";
//            }
//
//        }
//        else {
//            // Change icon and text
//            btn.children[0].className = "fa fa-eye-slash"
@* //            btn.lastChild.nodeValue = " Aktivní (@Model.Count(m => m.Active) / @Model.Count())" *@
//            var hiddenRows = document.querySelectorAll(".show.hiddenBefore");
//            for(var i = 0; i < hiddenRows.length; i++){
//                hiddenRows[i].className = "hide";
//            }
//        }
//    }

//    function idFormatter() {
//        return 'Total'
//    }

//    function nameFormatter(data) {
//        return data.length
//    }

//    function priceFormatterCz(data) {
//        var field = parseInt(this.field.replace(",", "").replace("&nbsp;", "").replace(" ", "").replace("Kč", ""));
//        //var field = parseInt(this.field).val().replace(/[^0-9]/g, '')
//        var vysledek = data.map(function (row) {
//            var cost = parseInt(row[field]
//                //.replace(/, (Kč)(&nbsp);/g, ''));
//                .replaceAllTxt(",", "")
//                .replaceAllTxt("&nbsp;", "")
//                .replaceAllTxt(" ", "")
//                .replaceAllTxt("Kč", "")
//                ) || 0;
//            return + cost
//        }).reduce(function (sum, i) {
//            return sum + i
//        }, 0)
//        return vysledek.toLocaleString('cs-CZ') + ' Kč'
//    }

//    function priceFormatter(data) {
//        var field = parseInt(this.field.replace(",", "").replace("&nbsp;", "").replace(" ", "").replace("Kč", ""));
//        console.log(field);
//        //var field = parseInt(this.field).val().replace(/[^0-9]/g, '')
//        var vysledek = data.map(function (row) {
//            var cost = parseInt(row[field]
//                //.replace(/, (Kč)(&nbsp);/g, ''));
//                .replaceAllTxt(",", "")
//                .replaceAllTxt("&nbsp;", "")
//                .replaceAllTxt(" ", "")
//                .replaceAllTxt("Kč", "")
//                ) || 0;
//            return + cost
//        }).reduce(function (sum, i) {
//            return sum + i
//        }, 0)
//        return vysledek
//    }

//    function footerStyle(row, index) {
//        return {
//            css: {
//            "font-weight": "bold"
//            }
//        };
//    };

</script>
}